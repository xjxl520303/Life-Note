<%*
// 参考：https://zh.wikipedia.org/wiki/%E6%A0%87%E7%82%B9%E7%AC%A6%E5%8F%B7
const symbols = {
	"项目符号": "•",
    "上横线": "‾",
    "下横线": "_",
    "浪线书名号": "﹏﹏",
    "专名号": "＿＿",
    "缺文号": "□", // 表示文字中缺字的符号。
    "着重号": ".", // 文字下方（直式时右方）画点。
    "间隔号 1": "·", // 占半个字的位置，居正中
    "间隔号 2": "．", // 占一个字的位置，居正中
    "省略号": "……", // 两个省略号连用时占四个字位置并须单独占一行
    "删节号": "⋯⋯",
    "连接号: 一字线": "－", // 占一个字的位置，上下居中
    "连接号: 短横线": "-", // 占半个字的位置，上下居中
    "连接号: 浪纹线": "～", // 占一个字的位置，上下居中
    "破折号": "——", // 占两个字的位置，中间不能断开，上下居中。
    "双问号": "⁇",
    "问号+叹号": "⁈",
    "叹号+问号": "⁉",
    "括号: 圆括号": ["（", "）"],
    "括号: 方括号": ["[", "]"],
    "括号: 大括号": ["{", "}"],
    "括号: 尖括号": ["<", ">"],
    "括号：六角括号": ["〔", "〕"],
    "括号：方头括号": ["【", "】"],
    "引号：正常": ["「", "」"],
    "引号：内部": ["『", "』"],
    "单书名号": ["〈", "〉"],
    "双书名号": ["《", "》"],
    "乘号": "×",
    "除号": "÷",
    "分": "′",
    "秒": "″",
    "毫秒": "㎳",
    "度": "°",
    "摄氏度": "℃",
    "法式度": "℉",
    "分钟/秒": "㎧",
    "厘米": "㎝",
    "千米": "㎞",
    "毫克": "㎎",
    "千克": "㎏",
    "百分号": "％",
    "千分号": "‰",
    "万分号": "‱",
    "正负号": "±",
    "负正号": "∓",
    "人民币": "￥",
    "美元": "＄",
    "欧元": "€",
    "英镑": "￡",
    "竖线 1": "│",
    "竖线 2": "║",
    "竖线 3": "┊",
    "分节符号": "§",
    "参考标记": "※",
    "箭头左": "←",
    "箭头上": "↑",
    "箭头右": "→",
    "箭头下": "↓",
    "⒈": "⒈",
    "⒉": "⒉",
    "⒊": "⒊",
    "⒋": "⒋",
    "⒌": "⒌",
    "⒍": "⒍",
    "⒎": "⒎",
    "⒏": "⒏",
    "⑴": "⑴",
    "⑵": "⑵",
    "⑶": "⑶",
    "⑷": "⑷",
    "⑸": "⑸",
    "㈠": "㈠",
    "㈡": "㈡",
    "㈢": "㈢",
    "㈣": "㈣",
    "㈤": "㈤",
	"➊": "➊",
	"➋": "➋",
	"➌": "➌",
	"➍": "➍",
	"➎": "➎",
	"①": "①",
	"②": "②",
	"③": "③",
	"④": "④",
	"⑤": "⑤",
    "✅": "✅",
    "✔": "✔",
    "✗": "✗",
    "⚠": "⚠",
    "❕": "❕",
    "❗": "❗",
    "🚫": "🚫",
    "💬": "💬",
    "★": "★",
    "✩": "✩",
    "✦": "✦",
    "😂": "😂",
    "🤔": "🤔",
    "🤣": "🤣",
    "㊙": "㊙",
    "🈲": "🈲",
    "⌘（command）": "⌘",
    "⌥（option）": "⌥",
    "⇧（shift）": "⇧",
    "⇪（caps lock）": "⇪",
    "⌃（control）": "⌃",
    "↩（return）": "↩",
    "⌅（enter）": "⌅",
}

const selectedSymbol = await tp.system.suggester(([k, v]) => {
    if (Array.isArray(v)) {
        return `${k}  ${v[0]}文字${v[1]}`
    } else {
        return `${k}  ${v}`
    }
}, Object.entries(symbols))

let result = tp.file.cursor()

if (selectedSymbol) {
    if (Array.isArray(selectedSymbol[1])) {
        if (tp.file.selection()) {
            result = `${selectedSymbol[1][0]}${tp.file.selection()}${selectedSymbol[1][1]}${result}`
        } else {
            result = `${selectedSymbol[1][0]}${result}${selectedSymbol[1][1]}`
        }
    } else {
        result = selectedSymbol[1] + result
    }
}
_%>

<%_ result _%>